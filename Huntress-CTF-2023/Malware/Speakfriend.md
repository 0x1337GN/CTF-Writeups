# Speakfriend

### Challenge Description
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/77be5775-897c-4b50-83f7-a5b41a33b18d)

### Solution
Interesting looking website:  
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/1aaf16d0-15c9-4365-b72b-1ee22781f421)

After looking around for a bit, we don't find anything interesting. It looks like a static website. Let's have a look at the provided attachment.

The archive contains an ELF binary which we open in Ghidra. Decompiling the main function, we can see some hex encoded values. The first one is `Mozilla` backwards because of endianess:  
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/57b516e9-6e45-44ea-9db0-8a6fd3711847)

So it must be using a special User-Agent. We can try extracting it with strings and we can by using this syntax:

```bash
strings main|grep Mozilla -A5|tr -d 'H\n'
```
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/01c85faa-24aa-448d-afa5-6bff71f3dcb6)

We get this interesting looking User-Agent that seems to include a GUID:

```
Mozilla/5.0 93bed45b-7b70-4097-9279-98a4aef0353e
```
What would happen if we access the given website using this User-Agent instead. We reload the page and intercept it with Burpsuite and modify the User-Agent:  
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/fb67cde0-8a7f-44cf-b945-ff8e211a1dfa)

We let go of the interception and we see that we get redirected to a sneaky C2 with the flag:  
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/219fc798-c712-4947-961e-efdbd9700772)

We can also do this easier with curl. We have to make sure that we pass the `-k` flag to ignore the SSL certificate, `-L` for it to follow redirects and `-A` to pass our User-Agent:  

```bash
curl -k -L https://chal.ctf.games:31049/ -A 'Mozilla/5.0 93bed45b-7b70-4097-9279-98a4aef0353e'
```
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/643fd5d6-822d-40b7-97c3-7f00ab3f209c)

flag{3f2567475c6def39501bab2865aeba60} 
