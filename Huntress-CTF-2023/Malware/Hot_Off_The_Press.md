# Opendir

### Challenge Description
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/92839e26-147a-4d29-8619-406ce8222330)

### Solution
When I see files without an extension, the first thing I do is run the `file` command on it to see if I can figure out what it is:

```bash
file hot_off_the_press
```
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/5256bfc1-754a-42e1-a44a-7c10e922c84e)

This indicated that this is an `UHarc archive` which is not something I've encountered before so I started googling:
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/975eb194-57f5-4664-ac26-c3b1cffe3fbd)

I soon found this tool: https://sam.gleske.net/uharc/
After installing it in a Windows VM, and renamed the file with the extension `.uha`, we can see that it is recognized and an icon is assigned to it:  

Because it has a password, we need to right click on it and decompress it securely:  
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/f0510987-c34a-4b47-84cf-09d39c5aae5c)

Inside the archive we find a powershell script:
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/2ab9aafd-5f02-4a84-82c2-523b568b1d48)

It can be seen that there is a Base64 blob split into several pieces which is Gzip compressed. I used Cyberchef to put it all back together and decode it then gunzip it.

![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/bab1972e-dfec-468e-a62b-f3522bd9b304)

The resulted file shows another powershell script:
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/9ee92356-d6de-4511-9dfc-f9f6e527d75f)

This one also has some Base64 blobs and decoding the first one gets us closer to the flag:
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/78f53ab9-63cc-442c-a9a1-40ce3900681a)

We have some empty new lines to hide the certurl command which is URL encoded.
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/7686726b-6d52-4d90-abfb-2a0eef0d4b1b)

flag{dbfe5f755a898ce5f2088b0892850bf7}
