# Thumb Drive

### Challenge Description
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/9fa4fa2c-c1a9-46a1-a500-5a2e751403a3)

### Solution
Reading the provided .lnk file, we can see a tinyurl link:  
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/82b33311-cc80-4d28-b10c-d69cfbd01b24)

We can expand this shortened URL if we want to see the full link without actually triggering it. There are multiple URL Expanders on the internet:  
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/2d606b24-5990-4a47-8097-266d398804f7)

It seems we have a Google drive fileshare:  
https://drive.google.com/file/d/1RUNqvPq6cWSs0rkqiHApEEAsCzaObT2B/view?usp=sharing

Accessing this we see it hosting a `usb.txt` file which has Base64 encoded data in it:  
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/89a4d35b-c77b-4835-a049-479ba720e614)

We put that data in Cyberchef and notice the `MZ` header which indicates an EXE or DLL file:  
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/4f843944-b2e4-4596-bdd7-0c6c1975a8ae)

Putting the file in Ghidra, we notice an `entry` and a `dllmain_` under the Functions category:  

![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/cba62a00-90fc-4bc9-a26f-cf0eeb515b88)

The `entry` mentions a parameter being required:  

![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/306cb251-05dd-4573-a396-adbffd57b29d)

At first I tried static analysis but as is often the case, the dynamic approach, although riskier, is faster. In a segregated Windows VM, I've run the DLL file giving it an argument of "DllMain" but it doesn't really matter what argument you give it as long as one is given: As soon as we do that, a messagebox comes up with our flag:  

![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/a1d9204b-a902-4169-8135-27a417c9ac50)

flag{0af2873a74cfa957ccb90cef814cfe3d}
