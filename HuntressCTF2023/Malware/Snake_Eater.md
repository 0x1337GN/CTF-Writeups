# Snake Eater

### Challenge Description
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/450b20c6-075c-4c20-a629-ad71b9a0e3c7)

### Solution
Running the file command on the executable we are given doesn't help much:
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/f3face6a-a846-4348-ab0e-86fbfe788330)

However, running `strings` on it, we get some indications that this is actually a Python script that has been obfuscated and compiled to a self contained binary.  
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/463b5c4b-e370-4dfb-8634-1e23577fe6f0)

If we put this in a Windows VM, we can see the icon mentioned in the challenge description which confirms it's a Python executable:  
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/1cbfd62f-f653-47e5-a6a7-0928d724e6ca)

I have to admit that I wasted a lot of time on this challenge trying to do static analysis. I struggled to decompile it to a clean and readable python code so after a couple of hours, I decided to do dynamic analysis instead.

In a segregated Windows VM, I started `Procmon` and configured it to show only processes started by my binary and find anything in the path where `flag` is mentioned:  
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/03dc3f98-1aeb-4285-9e97-8f01d5d61313)

Once I executed the binary, I immediately got the flag:
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/962efcbe-a81b-4f8f-bf42-f7a4e567777c)

flag{d1343a2fc5d8427801dd1fd417f12628}
