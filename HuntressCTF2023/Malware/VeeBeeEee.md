# VeeBeeEee

### Challenge Description
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/a61e1f53-d70c-474f-be0c-0508f3bab857)

### Solution
When looking at the contents of the file, we don't get much:
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/9b76c218-611f-4f35-a541-54282d54054e)

A closer look however, shows us that it starts with `#@-` which is generally an indicator of .VBE. This matches the file name given as a hint. VBE is encoded VBScript. If we search online for a decoder we can find an online option as well as a python3 script from JohnHammond who happens to also be the challenge creator so we are on the right track.

![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/3a247935-b86c-4e6c-9a07-a8d5c02da40b)

https://master.ayra.ch/vbs/vbs.aspx 
https://github.com/JohnHammond/vbe-decoder 

Using either of the tools, we get to the VBScript we care about:
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/89422436-3ed6-4fb4-8182-13862dc53de0)

It's quite long:
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/85e2db7b-e95e-4f24-b3b3-843077d3f21a)

But we don't have to statically figure out what's going on, we can do some dinamic analysis and add a `Wscript.Echo Code` to output the content of this variable into a Messagebox.

![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/f9261672-1c17-4d7a-933f-cdd841f407e3)

_CAUTION: Always use a segregated VM when doing dynamic analysis on potential malware, even in CTFs._

After we modified the script and run it, we get a message box in which we can see a pastebin link:
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/ef95155a-f002-486e-91be-2f7e75248201)

If we run the script with `cscript` instead, we can even get the output printed to the console so we can copy+paste from it:
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/668ada66-c8c8-405b-92a8-bc81152966c2)

Now that we have the link: https://pastebin.com/raw/SiYGwwcz we can find the flag:
![image](https://github.com/LazyTitan33/CTF-Writeups/assets/80063008/cd72b7df-3f1f-416a-aa32-9c1050def557)

flag{ed81d24958127a2adccfb343012cebff}
